<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè† House Loan Dashboard</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.8.0/umd/Recharts.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        function HouseLoanDashboard() {
          const [isAuthenticated, setIsAuthenticated] = useState(false);
          const [password, setPassword] = useState("");
          const [authError, setAuthError] = useState("");
          const [loanData, setLoanData] = useState(null);
          const [loading, setLoading] = useState(false);
          const [dataError, setDataError] = useState("");

          // Set your password here - this will be replaced by GitHub Actions
          const CORRECT_PASSWORD = "GITHUB_SECRET_PASSWORD";
          
          // Default data structure
          const DEFAULT_LOAN_DATA = {
            loanDetails: {
              startDate: "2024-05-01T00:00:00.000Z",
              amount: 220000,
              interestRate: 3.9,
              termYears: 30
            },
            additionalPayments: [
              { month: 6, amount: 9000, description: "November 2024" },
              { month: 9, amount: 12500, description: "February 2025" }
            ]
          };

          const [additionalPayments, setAdditionalPayments] = useState([]);
          const [newPayment, setNewPayment] = useState({ month: "", amount: "", description: "" });
          const [schedule, setSchedule] = useState([]);
          const [comparison, setComparison] = useState([]);
          const [currentMonth, setCurrentMonth] = useState(0);
          const [showFullTable, setShowFullTable] = useState(false);
          const [showPaymentManager, setShowPaymentManager] = useState(false);

          // Authentication handler
          const handleAuthentication = () => {
            if (password === CORRECT_PASSWORD) {
              setIsAuthenticated(true);
              setAuthError("");
              loadLoanData();
            } else {
              setAuthError("Incorrect password. Please try again.");
              setPassword("");
            }
          };

          // Load loan data from JSON file (GitHub hosted)
          const loadLoanData = async () => {
            setLoading(true);
            setDataError("");
            
            try {
              // Try to fetch from GitHub raw file URL
              const response = await fetch('./house-loan-data.json');
              
              if (response.ok) {
                const data = await response.json();
                setLoanData(data);
                setAdditionalPayments(data.additionalPayments || []);
                console.log("Loaded data from JSON file:", data);
              } else {
                throw new Error('JSON file not found');
              }
            } catch (error) {
              console.log("No JSON file found or error loading, using default data");
              setDataError("Using default loan data. Upload 'house-loan-data.json' to use your data.");
              setLoanData(DEFAULT_LOAN_DATA);
              setAdditionalPayments(DEFAULT_LOAN_DATA.additionalPayments);
            }
            
            setLoading(false);
          };

          // Calculate current month based on loan start date
          useEffect(() => {
            if (loanData) {
              const startDate = new Date(loanData.loanDetails.startDate);
              const today = new Date();
              const monthsDiff = (today.getFullYear() - startDate.getFullYear()) * 12 + 
                                (today.getMonth() - startDate.getMonth()) + 1;
              setCurrentMonth(Math.max(1, monthsDiff));
            }
          }, [loanData]);

          const calculateAmortization = (includeExtras = true) => {
            if (!loanData) return [];
            
            const loanAmount = loanData.loanDetails.amount;
            const annualInterest = loanData.loanDetails.interestRate / 100;
            const monthlyInterest = annualInterest / 12;
            const totalMonths = loanData.loanDetails.termYears * 12;
            
            // Process additional payments
            const oneTimePayments = {};
            if (includeExtras) {
              additionalPayments.forEach(payment => {
                const amount = parseFloat(payment.amount || 0);
                const month = parseInt(payment.month || 0);
                if (amount > 0 && month > 0) {
                  oneTimePayments[month] = (oneTimePayments[month] || 0) + amount;
                }
              });
            }

            // Calculate monthly payment
            let monthlyPayment;
            if (monthlyInterest === 0) {
              monthlyPayment = loanAmount / totalMonths;
            } else {
              monthlyPayment = loanAmount * (monthlyInterest * Math.pow(1 + monthlyInterest, totalMonths)) / (Math.pow(1 + monthlyInterest, totalMonths) - 1);
            }

            let balance = loanAmount;
            let amortization = [];
            let month = 1;
            let totalInterest = 0;
            let totalPrincipal = 0;

            while (balance > 0.01 && month <= 1000) {
              const interest = balance * monthlyInterest;
              let principal = monthlyPayment - interest;

              if (oneTimePayments[month]) {
                principal += oneTimePayments[month];
              }

              if (principal > balance) {
                principal = balance;
              }

              balance = Math.max(0, balance - principal);
              totalInterest += interest;
              totalPrincipal += principal;

              amortization.push({
                month,
                interest: parseFloat(interest.toFixed(2)),
                principal: parseFloat(principal.toFixed(2)),
                totalInterest: parseFloat(totalInterest.toFixed(2)),
                totalPrincipal: parseFloat(totalPrincipal.toFixed(2)),
                remainingBalance: parseFloat(balance.toFixed(2)),
                oneTimePayment: oneTimePayments[month] || 0,
                monthlyPayment: parseFloat(monthlyPayment.toFixed(2))
              });

              if (balance <= 0.01) break;
              month++;
            }

            return amortization;
          };

          // Calculate schedules when data changes
          useEffect(() => {
            if (loanData) {
              const withExtras = calculateAmortization(true);
              const withoutExtras = calculateAmortization(false);
              setSchedule(withExtras);
              setComparison(withoutExtras);
            }
          }, [loanData, additionalPayments]);

          // Calculate current loan status
          const getCurrentLoanStatus = () => {
            if (!currentMonth || !schedule.length || !loanData) return null;
            
            const monthNum = Math.min(currentMonth, schedule.length);
            const currentData = schedule[monthNum - 1];
            
            return {
              monthsPaid: monthNum,
              totalPaid: currentData.totalPrincipal + currentData.totalInterest,
              principalPaid: currentData.totalPrincipal,
              interestPaid: currentData.totalInterest,
              remainingBalance: currentData.remainingBalance,
              progressPercentage: ((loanData.loanDetails.amount - currentData.remainingBalance) / loanData.loanDetails.amount) * 100,
              monthsRemaining: schedule.length - monthNum,
              monthlyPayment: currentData.monthlyPayment,
              loanPaidOff: monthNum >= schedule.length
            };
          };

          const loanStatus = getCurrentLoanStatus();

          // Add new additional payment
          const addAdditionalPayment = () => {
            if (!newPayment.month || !newPayment.amount) {
              alert("Please fill in both month and amount");
              return;
            }

            const updatedPayments = [...additionalPayments, {
              month: parseInt(newPayment.month),
              amount: parseFloat(newPayment.amount),
              description: newPayment.description || `Month ${newPayment.month}`
            }].sort((a, b) => a.month - b.month);

            setAdditionalPayments(updatedPayments);
            setNewPayment({ month: "", amount: "", description: "" });
          };

          // Remove additional payment
          const removeAdditionalPayment = (index) => {
            const updatedPayments = additionalPayments.filter((_, i) => i !== index);
            setAdditionalPayments(updatedPayments);
          };

          // Format date for display
          const formatLoanDate = (monthNumber) => {
            if (!loanData) return "";
            const date = new Date(loanData.loanDetails.startDate);
            date.setMonth(date.getMonth() + monthNumber - 1);
            return date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
          };

          // Export updated data
          const exportUpdatedData = () => {
            if (!loanData) return;
            
            const exportData = {
              ...loanData,
              additionalPayments: additionalPayments,
              lastUpdated: new Date().toISOString(),
              currentStatus: loanStatus
            };

            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'house-loan-data.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
          };

          // Create chart data
          const createChartData = () => {
            const maxLength = Math.max(schedule.length, comparison.length);
            const chartData = [];
            
            let sampleInterval;
            if (maxLength <= 60) {
              sampleInterval = 1;
            } else if (maxLength <= 120) {
              sampleInterval = 2;
            } else if (maxLength <= 240) {
              sampleInterval = 3;
            } else {
              sampleInterval = 6;
            }
            
            if (!loanData) return chartData;
            
            chartData.push({
              month: 0,
              totalPrincipal: 0,
              totalInterest: 0,
              remainingBalance: loanData.loanDetails.amount,
              remainingBalanceNoExtras: loanData.loanDetails.amount,
              totalInterestNoExtras: 0,
              totalPrincipalNoExtras: 0
            });
            
            for (let month = sampleInterval; month <= maxLength; month += sampleInterval) {
              const withExtrasData = schedule[month - 1] || {};
              const withoutExtrasData = comparison[month - 1] || {};
              
              const withExtrasValues = withExtrasData.month ? withExtrasData : (schedule[schedule.length - 1] || {});
              const withoutExtrasValues = withoutExtrasData.month ? withoutExtrasData : (comparison[comparison.length - 1] || {});
              
              chartData.push({
                month,
                totalPrincipal: withExtrasValues.totalPrincipal || 0,
                totalInterest: withExtrasValues.totalInterest || 0,
                remainingBalance: withExtrasValues.remainingBalance || 0,
                remainingBalanceNoExtras: withoutExtrasValues.remainingBalance || 0,
                totalInterestNoExtras: withoutExtrasValues.totalInterest || 0,
                totalPrincipalNoExtras: withoutExtrasValues.totalPrincipal || 0
              });
            }
            
            if (maxLength % sampleInterval !== 0) {
              const withExtrasData = schedule[schedule.length - 1] || {};
              const withoutExtrasData = comparison[comparison.length - 1] || {};
              
              chartData.push({
                month: maxLength,
                totalPrincipal: withExtrasData.totalPrincipal || 0,
                totalInterest: withExtrasData.totalInterest || 0,
                remainingBalance: withExtrasData.remainingBalance || 0,
                remainingBalanceNoExtras: withoutExtrasData.remainingBalance || 0,
                totalInterestNoExtras: withoutExtrasData.totalInterest || 0,
                totalPrincipalNoExtras: withoutExtrasData.totalPrincipal || 0
              });
            }
            
            return chartData;
          };

          // Show authentication screen if not authenticated
          if (!isAuthenticated) {
            return (
              <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100">
                <div className="max-w-md w-full space-y-8 p-8 bg-white rounded-2xl shadow-xl">
                  <div className="text-center">
                    <h1 className="text-3xl font-bold text-gray-900 mb-2">üè† House Loan Dashboard</h1>
                    <p className="text-gray-600 mb-6">Enter password to access your loan data</p>
                  </div>
                  
                  <div className="space-y-4">
                    <div>
                      <input
                        type="password"
                        value={password}
                        onChange={(e) => setPassword(e.target.value)}
                        onKeyPress={(e) => e.key === 'Enter' && handleAuthentication()}
                        placeholder="Enter password"
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-lg"
                        autoFocus
                      />
                    </div>
                    
                    {authError && (
                      <div className="text-red-600 text-sm text-center bg-red-50 p-3 rounded-lg">
                        {authError}
                      </div>
                    )}
                    
                    <button
                      onClick={handleAuthentication}
                      className="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors font-semibold text-lg"
                    >
                      Access Dashboard
                    </button>
                  </div>
                  
                  <div className="text-center text-xs text-gray-500 mt-6">
                    <p>üîí Your data is protected with password authentication</p>
                    <p className="mt-2">üí° <strong>Tip:</strong> Upload your 'house-loan-data.json' file to load your data</p>
                  </div>
                </div>
              </div>
            );
          }

          // Show loading screen
          if (loading) {
            return (
              <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100">
                <div className="text-center">
                  <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                  <p className="text-gray-600">Loading your loan data...</p>
                </div>
              </div>
            );
          }

          const chartData = createChartData();

          return (
            <div className="max-w-6xl mx-auto p-6 bg-white shadow-xl rounded-2xl mt-10">
              {/* Header with logout */}
              <div className="flex justify-between items-start mb-8">
                <div className="text-center flex-1">
                  <h1 className="text-3xl font-bold text-blue-800 mb-2">üè† House Loan Dashboard</h1>
                  {loanData && (
                    <div className="text-sm text-gray-600 space-y-1">
                      <p><strong>Loan Start:</strong> {new Date(loanData.loanDetails.startDate).toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}</p>
                      <p><strong>Original Amount:</strong> ‚Ç¨{loanData.loanDetails.amount.toLocaleString()} | <strong>Interest Rate:</strong> {loanData.loanDetails.interestRate}% | <strong>Term:</strong> {loanData.loanDetails.termYears} years</p>
                      <p><strong>Current Date:</strong> {new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })} | <strong>Loan Month:</strong> {currentMonth}</p>
                    </div>
                  )}
                  
                  {dataError && (
                    <div className="text-orange-600 text-sm bg-orange-50 p-2 rounded-lg mt-2">
                      {dataError}
                    </div>
                  )}
                </div>
                
                <button
                  onClick={() => setIsAuthenticated(false)}
                  className="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors text-sm"
                >
                  üîê Logout
                </button>
              </div>

              {!loanData ? (
                <div className="text-center py-12">
                  <p className="text-gray-600 mb-4">No loan data available. Using default values.</p>
                </div>
              ) : (
                <>
                  {/* Management Buttons */}
                  <div className="flex flex-wrap gap-3 justify-center mb-6">
                    <button
                      onClick={() => setShowPaymentManager(!showPaymentManager)}
                      className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium"
                    >
                      {showPaymentManager ? 'Hide' : 'Manage'} Additional Payments
                    </button>
                    <button
                      onClick={exportUpdatedData}
                      className="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors font-medium"
                    >
                      üìÑ Export Updated Data
                    </button>
                  </div>

                  {/* Additional Payments Manager */}
                  {showPaymentManager && (
                    <div className="mb-8 bg-green-50 p-6 rounded-xl border border-green-200">
                      <h2 className="text-xl font-semibold mb-4 text-green-800">Additional Payments Manager</h2>
                      
                      <div className="grid grid-cols-1 md:grid-cols-4 gap-3 mb-4">
                        <input
                          type="number"
                          placeholder="Month #"
                          value={newPayment.month}
                          onChange={(e) => setNewPayment({...newPayment, month: e.target.value})}
                          className="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                        />
                        <input
                          type="number"
                          placeholder="Amount (‚Ç¨)"
                          value={newPayment.amount}
                          onChange={(e) => setNewPayment({...newPayment, amount: e.target.value})}
                          className="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                        />
                        <input
                          type="text"
                          placeholder="Description (optional)"
                          value={newPayment.description}
                          onChange={(e) => setNewPayment({...newPayment, description: e.target.value})}
                          className="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"
                        />
                        <button
                          onClick={addAdditionalPayment}
                          className="bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium"
                        >
                          Add Payment
                        </button>
                      </div>

                      {additionalPayments.length > 0 && (
                        <div>
                          <h3 className="font-semibold text-green-700 mb-2">Current Additional Payments:</h3>
                          <div className="space-y-2">
                            {additionalPayments.map((payment, index) => (
                              <div key={index} className="flex items-center justify-between bg-white p-3 rounded-lg border border-green-200">
                                <div className="flex items-center space-x-4">
                                  <span className="font-medium">Month {payment.month}</span>
                                  <span className="text-green-600 font-semibold">‚Ç¨{payment.amount.toLocaleString()}</span>
                                  <span className="text-sm text-gray-600">{payment.description}</span>
                                </div>
                                <button
                                  onClick={() => removeAdditionalPayment(index)}
                                  className="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors"
                                >
                                  Remove
                                </button>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}
                    </div>
                  )}

                  {/* Current Loan Status */}
                  {loanStatus && (
                    <div className="mb-8 bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-xl border border-purple-200">
                      <h2 className="text-xl font-semibold mb-4 text-purple-800">
                        Current Status - {formatLoanDate(currentMonth)} 
                        {loanStatus.loanPaidOff && <span className="ml-2 text-green-600">(LOAN PAID OFF! üéâ)</span>}
                      </h2>
                      
                      {!loanStatus.loanPaidOff && (
                        <div className="mb-6">
                          <div className="flex justify-between text-sm text-gray-600 mb-2">
                            <span>Loan Progress</span>
                            <span>{loanStatus.progressPercentage.toFixed(1)}% Complete</span>
                          </div>
                          <div className="w-full bg-gray-200 rounded-full h-4 overflow-hidden">
                            <div 
                              className="bg-gradient-to-r from-green-400 to-blue-500 h-4 rounded-full transition-all duration-500 ease-out"
                              style={{ width: `${loanStatus.progressPercentage}%` }}
                            ></div>
                          </div>
                        </div>
                      )}

                      {/* Status Cards */}
                      <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div className="bg-white p-4 rounded-lg shadow-sm">
                          <h3 className="font-semibold text-green-800 text-sm">Total Paid</h3>
                          <p className="text-lg font-bold text-green-600">‚Ç¨{loanStatus.totalPaid.toLocaleString()}</p>
                          <p className="text-xs text-gray-500">{loanStatus.monthsPaid} months</p>
                        </div>
                        <div className="bg-white p-4 rounded-lg shadow-sm">
                          <h3 className="font-semibold text-blue-800 text-sm">Principal Paid</h3>
                          <p className="text-lg font-bold text-blue-600">‚Ç¨{loanStatus.principalPaid.toLocaleString()}</p>
                          <p className="text-xs text-gray-500">Of loan amount</p>
                        </div>
                        <div className="bg-white p-4 rounded-lg shadow-sm">
                          <h3 className="font-semibold text-orange-800 text-sm">Interest Paid</h3>
                          <p className="text-lg font-bold text-orange-600">‚Ç¨{loanStatus.interestPaid.toLocaleString()}</p>
                          <p className="text-xs text-gray-500">Total interest so far</p>
                        </div>
                        <div className="bg-white p-4 rounded-lg shadow-sm">
                          <h3 className="font-semibold text-red-800 text-sm">{loanStatus.loanPaidOff ? 'Final Balance' : 'Remaining Balance'}</h3>
                          <p className="text-lg font-bold text-red-600">‚Ç¨{loanStatus.remainingBalance.toLocaleString()}</p>
                          <p className="text-xs text-gray-500">{loanStatus.loanPaidOff ? 'Paid off early!' : `${loanStatus.monthsRemaining} months left`}</p>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Comparison Stats */}
                  {schedule.length > 0 && comparison.length > 0 && (
                    <div className="mt-8 grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                      <div className="bg-blue-50 p-4 rounded-lg">
                        <h3 className="font-semibold text-blue-800">With Additional Payments</h3>
                        <p className="text-sm">Loan paid off in: <span className="font-bold">{schedule.length} months</span></p>
                        <p className="text-sm">Total interest: <span className="font-bold">‚Ç¨{schedule[schedule.length - 1]?.totalInterest.toLocaleString()}</span></p>
                      </div>
                      <div className="bg-gray-50 p-4 rounded-lg">
                        <h3 className="font-semibold text-gray-800">Without Additional Payments</h3>
                        <p className="text-sm">Loan paid off in: <span className="font-bold">{comparison.length} months</span></p>
                        <p className="text-sm">Total interest: <span className="font-bold">‚Ç¨{comparison[comparison.length - 1]?.totalInterest.toLocaleString()}</span></p>
                      </div>
                      <div className="bg-green-50 p-4 rounded-lg">
                        <h3 className="font-semibold text-green-800">Savings from Additional Payments</h3>
                        <p className="text-sm">Time saved: <span className="font-bold">{comparison.length - schedule.length} months</span></p>
                        <p className="text-sm">Interest saved: <span className="font-bold">‚Ç¨{(comparison[comparison.length - 1]?.totalInterest - schedule[schedule.length - 1]?.totalInterest).toLocaleString()}</span></p>
                      </div>
                    </div>
                  )}

                  {/* Chart */}
                  {schedule.length > 0 && window.Recharts && (
                    <div className="mt-8">
                      <h2 className="text-xl font-semibold mb-4">Payment Progress Chart</h2>
                      <Recharts.ResponsiveContainer width="100%" height={400}>
                        <Recharts.LineChart data={chartData}>
                          <Recharts.CartesianGrid strokeDasharray="3 3" />
                          <Recharts.XAxis 
                            dataKey="month" 
                            label={{ value: 'Months', position: 'insideBottom', offset: -10 }}
                          />
                          <Recharts.YAxis label={{ value: 'Amount (‚Ç¨)', angle: -90, position: 'insideLeft' }} />
                          <Recharts.Tooltip 
                            formatter={(value) => `‚Ç¨${parseFloat(value).toLocaleString()}`}
                            labelFormatter={(label) => `Month ${label}`}
                          />
                          <Recharts.Legend />
                          <Recharts.Line type="monotone" dataKey="totalPrincipal" stroke="#22c55e" name="Total Principal Paid (With Extras)" strokeWidth={3} dot={false} />
                          <Recharts.Line type="monotone" dataKey="totalInterest" stroke="#f59e0b" name="Total Interest Paid (With Extras)" strokeWidth={3} dot={false} />
                          <Recharts.Line type="monotone" dataKey="remainingBalance" stroke="#3b82f6" name="Remaining Balance (With Extras)" strokeWidth={3} dot={false} />
                          <Recharts.Line type="monotone" dataKey="totalPrincipalNoExtras" stroke="#86efac" name="Total Principal Paid (No Extras)" strokeDasharray="8 8" strokeWidth={2} dot={false} />
                          <Recharts.Line type="monotone" dataKey="totalInterestNoExtras" stroke="#fbbf24" name="Total Interest Paid (No Extras)" strokeDasharray="8 8" strokeWidth={2} dot={false} />
                          <Recharts.Line type="monotone" dataKey="remainingBalanceNoExtras" stroke="#93c5fd" name="Remaining Balance (No Extras)" strokeDasharray="8 8" strokeWidth={2} dot={false} />
                        </Recharts.LineChart>
                      </Recharts.ResponsiveContainer>
                    </div>
                  )}

                  {/* Amortization Table */}
                  {schedule.length > 0 && (
                    <div className="mt-8 overflow-x-auto">
                      <div className="flex items-center justify-between mb-4">
                        <h2 className="text-xl font-semibold">Amortization Schedule {showFullTable ? '(Complete)' : '(First 12 months)'}</h2>
                        <button
                          onClick={() => setShowFullTable(!showFullTable)}
                          className="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors text-sm font-medium"
                        >
                          {showFullTable ? 'Show First 12 Months' : 'Show Complete Table'}
                        </button>
                      </div>
                      <div className="max-h-96 overflow-y-auto border border-gray-200 rounded-lg">
                        <table className="min-w-full text-sm">
                          <thead className="bg-gray-50 sticky top-0">
                            <tr>
                              <th className="border border-gray-200 px-4 py-2 font-semibold">Month</th>
                              <th className="border border-gray-200 px-4 py-2 font-semibold">Date</th>
                              <th className="border border-gray-200 px-4 py-2 font-semibold">Payment (‚Ç¨)</th>
                              <th className="border border-gray-200 px-4 py-2 font-semibold">Principal (‚Ç¨)</th>
                              <th className="border border-gray-200 px-4 py-2 font-semibold">Interest (‚Ç¨)</th>
                              <th className="border border-gray-200 px-4 py-2 font-semibold">Additional Payment (‚Ç¨)</th>
                              <th className="border border-gray-200 px-4 py-2 font-semibold">Remaining Balance (‚Ç¨)</th>
                            </tr>
                          </thead>
                          <tbody>
                            {(showFullTable ? schedule : schedule.slice(0, 12)).map((row) => (
                              <tr key={row.month} className={`hover:bg-gray-50 ${row.month === currentMonth ? 'bg-blue-50 border-l-4 border-l-blue-500' : ''}`}>
                                <td className="border border-gray-200 px-4 py-2 text-center font-medium">
                                  {row.month}
                                  {row.month === currentMonth && <span className="ml-2 text-blue-600 text-xs">‚Üê Current</span>}
                                </td>
                                <td className="border border-gray-200 px-4 py-2 text-center">{formatLoanDate(row.month)}</td>
                                <td className="border border-gray-200 px-4 py-2 text-right">{(row.principal + row.interest).toLocaleString()}</td>
                                <td className="border border-gray-200 px-4 py-2 text-right">{(row.principal - row.oneTimePayment).toLocaleString()}</td>
                                <td className="border border-gray-200 px-4 py-2 text-right">{row.interest.toLocaleString()}</td>
                                <td className="border border-gray-200 px-4 py-2 text-right">
                                  {row.oneTimePayment > 0 ? (
                                    <span className="text-green-600 font-semibold">‚Ç¨{row.oneTimePayment.toLocaleString()}</span>
                                  ) : (
                                    '-'
                                  )}
                                </td>
                                <td className="border border-gray-200 px-4 py-2 text-right">{row.remainingBalance.toLocaleString()}</td>
                              </tr>
                            ))}
                          </tbody>
                        </table>
                      </div>
                      {showFullTable && schedule.length > 12 && (
                        <div className="mt-2 text-sm text-gray-600 text-center">
                          Showing all {schedule.length} months
                        </div>
                      )}
                    </div>
                  )}
                </>
              )}
            </div>
          );
        }
        
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<HouseLoanDashboard />);
    </script>
</body>
</html>